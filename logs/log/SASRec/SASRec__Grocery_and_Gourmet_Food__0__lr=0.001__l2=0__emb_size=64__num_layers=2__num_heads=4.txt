INFO:root:Namespace(model_name='SASRec', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-24 20:58:20 ---------------------------------------------
INFO:root:
===========================================
 Arguments          | Values               
===========================================
 batch_size         | 8192                
 data_appendix      |                     
 dataset            | Grocery_and_Gourm...
 dropout            | 0                   
 early_stop         | 10                  
 emb_size           | 64                  
 epoch              | 100                 
 eval_batch_size    | 256                 
 gpu                | 0                   
 history_max        | 20                  
 l2                 | 0                   
 lr                 | 0.001               
 main_metric        |                     
 num_heads          | 4                   
 num_layers         | 2                   
 num_neg            | 1                   
 num_workers        | 16                  
 optimizer          | Adam                
 random_seed        | 0                   
 save_final_results | 1                   
 test_all           | 0                   
 topk               | 5,10,20,50          
===========================================
INFO:root:Device: cuda
INFO:root:Load corpus from data/Grocery_and_Gourmet_Food/SeqReader.pkl
INFO:root:#params: 601152
INFO:root:SASRec(
  (i_embeddings): Embedding(8714, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0-1): 2 x TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@5:0.0484,NDCG@5:0.0290,HR@10:0.0967,NDCG@10:0.0444,HR@20:0.1965,NDCG@20:0.0694,HR@50:0.4919,NDCG@50:0.1270)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.6187 [2.1 s]	dev=(HR@5:0.2444,NDCG@5:0.1564) [0.7 s] *
INFO:root:Epoch 2     loss=0.4932 [1.1 s]	dev=(HR@5:0.2459,NDCG@5:0.1596) [0.7 s] *
INFO:root:Epoch 3     loss=0.4439 [1.0 s]	dev=(HR@5:0.2469,NDCG@5:0.1607) [0.7 s] *
INFO:root:Epoch 4     loss=0.4214 [1.1 s]	dev=(HR@5:0.2508,NDCG@5:0.1652) [0.7 s] *
INFO:root:Epoch 5     loss=0.4001 [1.0 s]	dev=(HR@5:0.2654,NDCG@5:0.1755) [0.7 s] *
INFO:root:Epoch 6     loss=0.3797 [1.0 s]	dev=(HR@5:0.2817,NDCG@5:0.1889) [0.8 s] *
INFO:root:Epoch 7     loss=0.3587 [1.1 s]	dev=(HR@5:0.2973,NDCG@5:0.2010) [0.7 s] *
INFO:root:Epoch 8     loss=0.3414 [1.0 s]	dev=(HR@5:0.3227,NDCG@5:0.2217) [0.7 s] *
INFO:root:Epoch 9     loss=0.3231 [1.0 s]	dev=(HR@5:0.3362,NDCG@5:0.2344) [0.6 s] *
INFO:root:Epoch 10    loss=0.3063 [1.0 s]	dev=(HR@5:0.3466,NDCG@5:0.2430) [0.7 s] *
INFO:root:Epoch 11    loss=0.2907 [1.1 s]	dev=(HR@5:0.3611,NDCG@5:0.2561) [0.8 s] *
INFO:root:Epoch 12    loss=0.2764 [1.1 s]	dev=(HR@5:0.3693,NDCG@5:0.2605) [0.7 s] *
INFO:root:Epoch 13    loss=0.2620 [1.1 s]	dev=(HR@5:0.3788,NDCG@5:0.2703) [0.7 s] *
INFO:root:Epoch 14    loss=0.2503 [1.0 s]	dev=(HR@5:0.3887,NDCG@5:0.2807) [0.7 s] *
INFO:root:Epoch 15    loss=0.2384 [1.1 s]	dev=(HR@5:0.3992,NDCG@5:0.2898) [0.7 s] *
INFO:root:Epoch 16    loss=0.2291 [1.1 s]	dev=(HR@5:0.4015,NDCG@5:0.2940) [0.6 s] *
INFO:root:Epoch 17    loss=0.2176 [1.0 s]	dev=(HR@5:0.4030,NDCG@5:0.2964) [0.6 s] *
INFO:root:Epoch 18    loss=0.2080 [1.0 s]	dev=(HR@5:0.4098,NDCG@5:0.3026) [0.8 s] *
INFO:root:Epoch 19    loss=0.1993 [1.0 s]	dev=(HR@5:0.4119,NDCG@5:0.3049) [0.7 s] *
INFO:root:Epoch 20    loss=0.1900 [1.1 s]	dev=(HR@5:0.4145,NDCG@5:0.3085) [0.7 s] *
INFO:root:Epoch 21    loss=0.1802 [1.1 s]	dev=(HR@5:0.4166,NDCG@5:0.3110) [0.6 s] *
INFO:root:Epoch 22    loss=0.1737 [1.0 s]	dev=(HR@5:0.4239,NDCG@5:0.3168) [0.7 s] *
INFO:root:Epoch 23    loss=0.1674 [1.0 s]	dev=(HR@5:0.4221,NDCG@5:0.3155) [0.8 s]
INFO:root:Epoch 24    loss=0.1599 [1.1 s]	dev=(HR@5:0.4234,NDCG@5:0.3165) [0.7 s]
INFO:root:Epoch 25    loss=0.1527 [1.0 s]	dev=(HR@5:0.4252,NDCG@5:0.3189) [0.6 s] *
INFO:root:Epoch 26    loss=0.1465 [1.0 s]	dev=(HR@5:0.4286,NDCG@5:0.3223) [0.8 s] *
INFO:root:Epoch 27    loss=0.1420 [1.1 s]	dev=(HR@5:0.4303,NDCG@5:0.3250) [0.8 s] *
INFO:root:Epoch 28    loss=0.1381 [1.0 s]	dev=(HR@5:0.4298,NDCG@5:0.3250) [0.6 s]
INFO:root:Epoch 29    loss=0.1316 [1.1 s]	dev=(HR@5:0.4310,NDCG@5:0.3250) [0.8 s]
INFO:root:Epoch 30    loss=0.1251 [1.1 s]	dev=(HR@5:0.4311,NDCG@5:0.3257) [0.7 s] *
INFO:root:Epoch 31    loss=0.1223 [1.1 s]	dev=(HR@5:0.4336,NDCG@5:0.3310) [0.7 s] *
INFO:root:Epoch 32    loss=0.1172 [1.1 s]	dev=(HR@5:0.4346,NDCG@5:0.3304) [0.8 s]
INFO:root:Epoch 33    loss=0.1138 [1.1 s]	dev=(HR@5:0.4329,NDCG@5:0.3288) [0.6 s]
INFO:root:Epoch 34    loss=0.1096 [1.1 s]	dev=(HR@5:0.4315,NDCG@5:0.3301) [0.8 s]
INFO:root:Epoch 35    loss=0.1064 [1.0 s]	dev=(HR@5:0.4321,NDCG@5:0.3291) [0.6 s]
INFO:root:Epoch 36    loss=0.1026 [1.1 s]	dev=(HR@5:0.4300,NDCG@5:0.3299) [0.7 s]
INFO:root:Epoch 37    loss=0.0994 [1.0 s]	dev=(HR@5:0.4368,NDCG@5:0.3351) [0.6 s] *
INFO:root:Epoch 38    loss=0.0966 [1.1 s]	dev=(HR@5:0.4304,NDCG@5:0.3321) [0.5 s]
INFO:root:Epoch 39    loss=0.0928 [1.0 s]	dev=(HR@5:0.4346,NDCG@5:0.3336) [0.7 s]
INFO:root:Epoch 40    loss=0.0896 [1.0 s]	dev=(HR@5:0.4340,NDCG@5:0.3343) [0.7 s]
INFO:root:Epoch 41    loss=0.0871 [1.1 s]	dev=(HR@5:0.4322,NDCG@5:0.3328) [0.7 s]
INFO:root:Epoch 42    loss=0.0858 [1.0 s]	dev=(HR@5:0.4368,NDCG@5:0.3354) [0.7 s] *
INFO:root:Epoch 43    loss=0.0833 [1.0 s]	dev=(HR@5:0.4304,NDCG@5:0.3309) [0.8 s]
INFO:root:Epoch 44    loss=0.0804 [1.0 s]	dev=(HR@5:0.4338,NDCG@5:0.3334) [0.7 s]
INFO:root:Epoch 45    loss=0.0774 [1.0 s]	dev=(HR@5:0.4303,NDCG@5:0.3322) [0.6 s]
INFO:root:Epoch 46    loss=0.0760 [1.1 s]	dev=(HR@5:0.4353,NDCG@5:0.3352) [0.7 s]
INFO:root:Epoch 47    loss=0.0745 [1.0 s]	dev=(HR@5:0.4351,NDCG@5:0.3367) [0.7 s] *
INFO:root:Epoch 48    loss=0.0712 [1.0 s]	dev=(HR@5:0.4323,NDCG@5:0.3340) [0.7 s]
INFO:root:Epoch 49    loss=0.0697 [1.1 s]	dev=(HR@5:0.4376,NDCG@5:0.3378) [0.7 s] *
INFO:root:Epoch 50    loss=0.0677 [1.0 s]	dev=(HR@5:0.4286,NDCG@5:0.3323) [0.8 s]
INFO:root:Epoch 51    loss=0.0656 [1.1 s]	dev=(HR@5:0.4341,NDCG@5:0.3354) [0.7 s]
INFO:root:Epoch 52    loss=0.0640 [1.0 s]	dev=(HR@5:0.4325,NDCG@5:0.3344) [0.7 s]
INFO:root:Epoch 53    loss=0.0626 [1.1 s]	dev=(HR@5:0.4297,NDCG@5:0.3322) [0.7 s]
INFO:root:Epoch 54    loss=0.0600 [1.0 s]	dev=(HR@5:0.4331,NDCG@5:0.3349) [0.7 s]
INFO:root:Epoch 55    loss=0.0598 [1.1 s]	dev=(HR@5:0.4295,NDCG@5:0.3327) [0.6 s]
INFO:root:Epoch 56    loss=0.0572 [1.1 s]	dev=(HR@5:0.4300,NDCG@5:0.3340) [0.7 s]
INFO:root:Epoch 57    loss=0.0575 [1.1 s]	dev=(HR@5:0.4290,NDCG@5:0.3322) [0.7 s]
INFO:root:Epoch 58    loss=0.0557 [1.1 s]	dev=(HR@5:0.4343,NDCG@5:0.3358) [0.8 s]
INFO:root:Early stop at 58 based on dev result.
INFO:root:
Best Iter(dev)=   49	 dev=(HR@5:0.4376,NDCG@5:0.3378) [102.4 s] 
INFO:root:Load model from ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__0__lr=0.001__l2=0__emb_size=64__num_layers=2__num_heads=4.pt
INFO:root:
Dev  After Training: (HR@5:0.4376,NDCG@5:0.3378,HR@10:0.5284,NDCG@10:0.3671,HR@20:0.6312,NDCG@20:0.3930,HR@50:0.8071,NDCG@50:0.4277)
INFO:root:
Test After Training: (HR@5:0.3917,NDCG@5:0.2957,HR@10:0.4775,NDCG@10:0.3233,HR@20:0.5847,NDCG@20:0.3503,HR@50:0.7716,NDCG@50:0.3872)
INFO:root:Saving top-100 recommendation results to: ../log/SASRec/SASRec__Grocery_and_Gourmet_Food__0__lr=0/rec-SASRec-dev.csv
INFO:root:dev Prediction results saved!
INFO:root:Saving top-100 recommendation results to: ../log/SASRec/SASRec__Grocery_and_Gourmet_Food__0__lr=0/rec-SASRec-test.csv
INFO:root:test Prediction results saved!
INFO:root:
--------------------------------------------- END: 2025-12-24 21:00:12 ---------------------------------------------
